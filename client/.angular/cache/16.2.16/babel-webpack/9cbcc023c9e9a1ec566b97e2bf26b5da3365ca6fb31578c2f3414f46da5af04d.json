{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../core/services/version.service\";\nfunction VersionHistoryComponent_app_loader_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-loader\");\n  }\n}\nfunction VersionHistoryComponent_div_4_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 9)(1, \"div\")(2, \"p\", 10);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\", 11);\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"p\", 12);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function VersionHistoryComponent_div_4_div_1_Template_button_click_9_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const v_r4 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r5.restore(v_r4.version));\n    });\n    i0.ɵɵtext(10, \" Restore \");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const v_r4 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" Version \", v_r4.version, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\" Edited by \", (v_r4.editedBy == null ? null : v_r4.editedBy.name) || \"Unknown\", \" \\u00B7 \", i0.ɵɵpipeBind2(6, 5, v_r4.createdAt, \"medium\"), \" \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", v_r4.changeNote || \"No change note provided.\", \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"disabled\", ctx_r3.restoringVersion === v_r4.version);\n  }\n}\nfunction VersionHistoryComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 7);\n    i0.ɵɵtemplate(1, VersionHistoryComponent_div_4_div_1_Template, 11, 8, \"div\", 8);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.versions);\n  }\n}\nfunction VersionHistoryComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 14);\n    i0.ɵɵtext(1, \" No version history available. \");\n    i0.ɵɵelementEnd();\n  }\n}\nexport class VersionHistoryComponent {\n  constructor(route, router, versionService) {\n    this.route = route;\n    this.router = router;\n    this.versionService = versionService;\n    this.versions = [];\n    this.isLoading = false;\n    this.restoringVersion = null;\n  }\n  ngOnInit() {\n    const id = this.route.snapshot.paramMap.get('id');\n    if (!id) {\n      this.router.navigate(['/dashboard']);\n      return;\n    }\n    this.documentId = id;\n    this.loadVersions();\n  }\n  loadVersions() {\n    this.isLoading = true;\n    this.versionService.getVersions(this.documentId).subscribe({\n      next: res => {\n        this.versions = res;\n        this.isLoading = false;\n      },\n      error: () => {\n        this.isLoading = false;\n      }\n    });\n  }\n  restore(version) {\n    if (!confirm(`Restore document to version ${version}?`)) {\n      return;\n    }\n    this.restoringVersion = version;\n    this.versionService.restoreVersion(this.documentId, version).subscribe({\n      next: () => {\n        this.restoringVersion = null;\n        this.goBack();\n      },\n      error: () => {\n        this.restoringVersion = null;\n        alert('Failed to restore version.');\n      }\n    });\n  }\n  /** ✅ SAFE for template */\n  goBack() {\n    this.router.navigate(['/dashboard/view', this.documentId]);\n  }\n  static {\n    this.ɵfac = function VersionHistoryComponent_Factory(t) {\n      return new (t || VersionHistoryComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.VersionService));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: VersionHistoryComponent,\n      selectors: [[\"app-version-history\"]],\n      decls: 9,\n      vars: 3,\n      consts: [[1, \"p-6\"], [1, \"text-2xl\", \"font-bold\", \"mb-4\"], [4, \"ngIf\"], [\"class\", \"space-y-3\", 4, \"ngIf\"], [\"class\", \"text-gray-500 mt-6\", 4, \"ngIf\"], [1, \"mt-6\"], [1, \"text-blue-600\", \"hover:underline\", 3, \"click\"], [1, \"space-y-3\"], [\"class\", \"border rounded p-4 bg-white shadow-sm flex justify-between items-center\", 4, \"ngFor\", \"ngForOf\"], [1, \"border\", \"rounded\", \"p-4\", \"bg-white\", \"shadow-sm\", \"flex\", \"justify-between\", \"items-center\"], [1, \"font-semibold\"], [1, \"text-sm\", \"text-gray-500\"], [1, \"text-sm\", \"text-gray-600\", \"mt-1\"], [1, \"px-4\", \"py-2\", \"bg-blue-600\", \"text-white\", \"rounded\", \"hover:bg-blue-700\", \"disabled:opacity-50\", 3, \"disabled\", \"click\"], [1, \"text-gray-500\", \"mt-6\"]],\n      template: function VersionHistoryComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\", 1);\n          i0.ɵɵtext(2, \"Version History\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(3, VersionHistoryComponent_app_loader_3_Template, 1, 0, \"app-loader\", 2);\n          i0.ɵɵtemplate(4, VersionHistoryComponent_div_4_Template, 2, 1, \"div\", 3);\n          i0.ɵɵtemplate(5, VersionHistoryComponent_div_5_Template, 2, 0, \"div\", 4);\n          i0.ɵɵelementStart(6, \"div\", 5)(7, \"button\", 6);\n          i0.ɵɵlistener(\"click\", function VersionHistoryComponent_Template_button_click_7_listener() {\n            return ctx.goBack();\n          });\n          i0.ɵɵtext(8, \" \\u2190 Back to Document \");\n          i0.ɵɵelementEnd()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngIf\", ctx.isLoading);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", !ctx.isLoading && ctx.versions.length > 0);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", !ctx.isLoading && ctx.versions.length === 0);\n        }\n      },\n      styles: [\"/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJ2ZXJzaW9uLWhpc3RvcnkuY29tcG9uZW50LmNzcyJ9 */\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvZGFzaGJvYXJkL3ZlcnNpb24taGlzdG9yeS92ZXJzaW9uLWhpc3RvcnkuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQ0EsNEtBQTRLIiwic291cmNlUm9vdCI6IiJ9 */\"]\n    });\n  }\n}","map":{"version":3,"names":["i0","ɵɵelement","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵlistener","VersionHistoryComponent_div_4_div_1_Template_button_click_9_listener","restoredCtx","ɵɵrestoreView","_r6","v_r4","$implicit","ctx_r5","ɵɵnextContext","ɵɵresetView","restore","version","ɵɵadvance","ɵɵtextInterpolate1","ɵɵtextInterpolate2","editedBy","name","ɵɵpipeBind2","createdAt","changeNote","ɵɵproperty","ctx_r3","restoringVersion","ɵɵtemplate","VersionHistoryComponent_div_4_div_1_Template","ctx_r1","versions","VersionHistoryComponent","constructor","route","router","versionService","isLoading","ngOnInit","id","snapshot","paramMap","get","navigate","documentId","loadVersions","getVersions","subscribe","next","res","error","confirm","restoreVersion","goBack","alert","ɵɵdirectiveInject","i1","ActivatedRoute","Router","i2","VersionService","selectors","decls","vars","consts","template","VersionHistoryComponent_Template","rf","ctx","VersionHistoryComponent_app_loader_3_Template","VersionHistoryComponent_div_4_Template","VersionHistoryComponent_div_5_Template","VersionHistoryComponent_Template_button_click_7_listener","length"],"sources":["C:\\Users\\Bharat Singh\\Desktop\\companies\\Smartwinnr\\Document Management System\\client\\src\\app\\dashboard\\version-history\\version-history.component.ts","C:\\Users\\Bharat Singh\\Desktop\\companies\\Smartwinnr\\Document Management System\\client\\src\\app\\dashboard\\version-history\\version-history.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { VersionService } from '../../core/services/version.service';\r\n\r\n@Component({\r\n  selector: 'app-version-history',\r\n  templateUrl: './version-history.component.html',\r\n  styleUrls: ['./version-history.component.css']\r\n})\r\nexport class VersionHistoryComponent implements OnInit {\r\n\r\n  documentId!: string;\r\n  versions: any[] = [];\r\n  isLoading = false;\r\n  restoringVersion: number | null = null;\r\n\r\n  constructor(\r\n    private route: ActivatedRoute,\r\n    private router: Router,\r\n    private versionService: VersionService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    const id = this.route.snapshot.paramMap.get('id');\r\n    if (!id) {\r\n      this.router.navigate(['/dashboard']);\r\n      return;\r\n    }\r\n    this.documentId = id;\r\n    this.loadVersions();\r\n  }\r\n\r\n  loadVersions(): void {\r\n    this.isLoading = true;\r\n    this.versionService.getVersions(this.documentId).subscribe({\r\n      next: (res) => {\r\n        this.versions = res;\r\n        this.isLoading = false;\r\n      },\r\n      error: () => {\r\n        this.isLoading = false;\r\n      }\r\n    });\r\n  }\r\n\r\n  restore(version: number): void {\r\n    if (!confirm(`Restore document to version ${version}?`)) {\r\n      return;\r\n    }\r\n\r\n    this.restoringVersion = version;\r\n\r\n    this.versionService.restoreVersion(this.documentId, version).subscribe({\r\n      next: () => {\r\n        this.restoringVersion = null;\r\n        this.goBack();\r\n      },\r\n      error: () => {\r\n        this.restoringVersion = null;\r\n        alert('Failed to restore version.');\r\n      }\r\n    });\r\n  }\r\n\r\n  /** ✅ SAFE for template */\r\n  goBack(): void {\r\n    this.router.navigate(['/dashboard/view', this.documentId]);\r\n  }\r\n}\r\n","<div class=\"p-6\">\r\n\r\n  <h2 class=\"text-2xl font-bold mb-4\">Version History</h2>\r\n\r\n  <!-- Loader -->\r\n  <app-loader *ngIf=\"isLoading\"></app-loader>\r\n\r\n  <!-- Versions -->\r\n  <div *ngIf=\"!isLoading && versions.length > 0\" class=\"space-y-3\">\r\n\r\n    <div\r\n      *ngFor=\"let v of versions\"\r\n      class=\"border rounded p-4 bg-white shadow-sm flex justify-between items-center\"\r\n    >\r\n      <div>\r\n        <p class=\"font-semibold\">\r\n          Version {{ v.version }}\r\n        </p>\r\n\r\n        <p class=\"text-sm text-gray-500\">\r\n          Edited by {{ v.editedBy?.name || 'Unknown' }}\r\n          · {{ v.createdAt | date:'medium' }}\r\n        </p>\r\n\r\n        <p class=\"text-sm text-gray-600 mt-1\">\r\n          {{ v.changeNote || 'No change note provided.' }}\r\n        </p>\r\n      </div>\r\n\r\n      <button\r\n        (click)=\"restore(v.version)\"\r\n        [disabled]=\"restoringVersion === v.version\"\r\n        class=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50\"\r\n      >\r\n        Restore\r\n      </button>\r\n    </div>\r\n\r\n  </div>\r\n\r\n  <!-- Empty state -->\r\n  <div *ngIf=\"!isLoading && versions.length === 0\" class=\"text-gray-500 mt-6\">\r\n    No version history available.\r\n  </div>\r\n\r\n  <!-- Back -->\r\n  <div class=\"mt-6\">\r\n  <button\r\n    (click)=\"goBack()\"\r\n    class=\"text-blue-600 hover:underline\"\r\n  >\r\n    ← Back to Document\r\n  </button>\r\n</div>\r\n\r\n\r\n</div>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}